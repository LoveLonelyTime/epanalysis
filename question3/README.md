# 任务三

## 任务需求

依据时间序列，预测最有可能成为高价值客户的TOP5，结果保存 “居民客户的用电缴费习惯分析 3.csv”

## 技术说明

### 基于客户忠诚/价值指标的客户聚类

#### 基于RFM分析计算客户忠诚/价值指标

最 近 购 买 时 间 (recency )、 购 买 频 率(frequency)和总购买金额(monetary value)综合分析(简称 RFM 分析)是一种重要的评价客户终生价值的方法

1. 最近购买时间 R(recency), 即从上次购买到当前的 时间间隔 , 该值越小意味着客户再次购买的可能性越大 

2. 购买频率 F(frequency), 即客户在某一时间段内总的购买次数 , 购买频率越高表示客户越忠诚 

3. 总购买金额 M(monetary value), 即某一时间段内客户的消费总额, 该值越大意味着客户对公司的利润贡献越大

为了避免 R , F , M 指标 中的孤立点对规范化结果的影响 ,采用z-score 变量规范化方法以对最近购买时间 R 指标的规范化为例, 设第 i 个客户的 R 值为 $ R_i $ , 则利用式 $ R^{\prime}_i =(R_i - R) / (\sigma R) $ 将其规范化成 $ R^{\prime}_i $,其中 , 和 $ \sigma R $ 分别为指标 R 的平均值和标准差,可以采用类似的方法对 F 和 M 指标进行规范化处理。

可以利用下式对三个指标进行合 成,获得能够综合反映客户忠诚度和价值度的“客 户忠诚-价值指标”(简称 CLV 指标):

$$ CLV_{i} = -w_1R^{\prime}_i +w_2F^{\prime}_i +w_2M $$

其中 $ R^{\prime}_i $ , $ F^{\prime}_i $ , $ M^{\prime}_i $  分别为经过规范化处理后第 i 个客户的 RFM 指标值， $ w_1 $ ,$ w_2 $ , $ w_3 $ 为三个指标所占的权重，将三
个指标进行两两对比并建立判断矩阵, 然后求出判断矩阵的最大特征值和相应的特征向量· 进一步对判断矩阵进行一致性检验, 如果判断矩阵的一致性符合要求 , 则将特征向量中的各分量分别
作为三个指标的权系数，利用此方法算出， $ w_1 $ ,$ w_2 $ , $ w_3 $ 大约为 0.2，0.35，0.45

#### 基于k-Means方法的客户聚类

通过上述计算得到的CLV值进行K-Means聚类，经过反复测试发现分为7簇时较为准确，对于每个客户给出一个类别

### 基于朴素贝叶斯分类的客户价值预测方法

将计算得到的CLV值和刚才得到的类别作为训练集，采用高斯朴素贝叶斯模型得到预测新客户价值预测模型

### 预测最有可能成为高价值客户的TOP5

数据通过朴素贝叶斯模型会得到属于每个类别的概率，取CLV值最大的那个类别的概率进行排序，概率最大前五个即为所求最有可能成为高价值客户的Top5

## 操作说明

建议使用train.ipynb和Project3.ipynb

### 数据说明

训练和预测数据为xlsx格式，有3列，为用户编号，缴费日期，缴费金额（元）

### 训练方法

1. 修改train.ipynb中的filename变量为训练集路径
2. 运行程序
3. 模型保存在model文件夹下

### 使用方法

1. 修改Project3.ipynb中的filename变量为所要预测的数据
2. 运行程序
3. 得到的结果显示在最后，并储存在居民客户的用电缴费习惯分析3.csv

## 模型评估

使用accuracy score作为评估标准，模型分数为0.96，详见train.ipynb下IN 14
